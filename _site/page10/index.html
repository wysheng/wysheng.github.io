<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>王者勇胜</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/page10/">
    <link rel="alternate" type="application/rss+xml" title="王者勇胜" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?cf8506e0ef223e57ff6239944e5d46a4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-72449510-4', 'auto');
      ga('send', 'pageview');

    </script>



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">王者勇胜</a>
        <small>生活不止眼前的代码和苟且，还有诗和远方！</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>主页
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>归档
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>目录
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>标签
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>收藏
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/life/">
                        
                            <i class="fa fa-heart"></i>我的诗词
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>关于我
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>王者勇胜：Welcome to wysheng's Blog!</h1>
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/03/01/Hadoop1/">Hadoop环境搭建</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-03-01
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#大数据技术" title="Category: 大数据技术" rel="category">大数据技术</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Hadoop" title="Tag: Hadoop" rel="tag">Hadoop</a>&nbsp;
    
        <a href="/tag/#大数据技术" title="Tag: 大数据技术" rel="tag">大数据技术</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#前言" id="markdown-toc-前言">前言</a></li>
  <li><a href="#第一部分linux环境安装" id="markdown-toc-第一部分linux环境安装">第一部分：Linux环境安装</a></li>
  <li><a href="#第二部分hadoop本地模式安装" id="markdown-toc-第二部分hadoop本地模式安装">第二部分：Hadoop本地模式安装</a></li>
  <li><a href="#第三部分hadoop伪分布式模式安装" id="markdown-toc-第三部分hadoop伪分布式模式安装">第三部分：Hadoop伪分布式模式安装</a></li>
  <li><a href="#第四部分完全分布式安装" id="markdown-toc-第四部分完全分布式安装">第四部分：完全分布式安装</a></li>
  <li><a href="#第五部分hadoop-ha安装" id="markdown-toc-第五部分hadoop-ha安装">第五部分：Hadoop HA安装</a></li>
  <li><a href="#第三步安装jdk" id="markdown-toc-第三步安装jdk">第三步、安装JDK</a></li>
  <li><a href="#第二部分hadoop本地模式安装-1" id="markdown-toc-第二部分hadoop本地模式安装-1">第二部分：Hadoop本地模式安装</a></li>
  <li><a href="#第四步hadoop部署模式" id="markdown-toc-第四步hadoop部署模式">第四步、Hadoop部署模式</a></li>
  <li><a href="#第五步本地模式部署" id="markdown-toc-第五步本地模式部署">第五步、本地模式部署</a></li>
  <li><a href="#第三部分hadoop伪分布式模式安装-1" id="markdown-toc-第三部分hadoop伪分布式模式安装-1">第三部分：Hadoop伪分布式模式安装</a></li>
  <li><a href="#第六步伪分布式hadoop部署过程" id="markdown-toc-第六步伪分布式hadoop部署过程">第六步、伪分布式Hadoop部署过程</a></li>
  <li><a href="#第七步开启历史服务" id="markdown-toc-第七步开启历史服务">第七步、开启历史服务</a></li>
  <li><a href="#第十一步hadoop-2x-hdfs-ha-部署" id="markdown-toc-第十一步hadoop-2x-hdfs-ha-部署">第十一步、Hadoop 2.x HDFS HA 部署</a></li>
  <li><a href="#第十二步hadoop-2x-yarn-ha-部署" id="markdown-toc-第十二步hadoop-2x-yarn-ha-部署">第十二步、Hadoop 2.x YARN HA 部署</a></li>
</ul>

<h2 id="前言">前言</h2>
<p>Hadoop在大数据技术体系中的地位至关重要，Hadoop是大数据技术的基础，对Hadoop基础知识的掌握的扎实程度，会决定在大数据技术道路上走多远。</p>

<p>这是一篇入门文章，Hadoop的学习方法很多，网上也有很多学习路线图。本文的思路是：以安装部署Apache Hadoop2.x版本为主线，来介绍Hadoop2.x的架构组成、各模块协同工作原理、技术细节。安装不是目的，通过安装认识Hadoop才是目的。</p>

<p>本文分为五个部分、十三节、四十九步。</p>

<h2 id="第一部分linux环境安装">第一部分：Linux环境安装</h2>
<p>Hadoop是运行在Linux，虽然借助工具也可以运行在Windows上，但是建议还是运行在Linux系统上，第一部分介绍Linux环境的安装、配置、Java JDK安装等。</p>

<h2 id="第二部分hadoop本地模式安装">第二部分：Hadoop本地模式安装</h2>
<p>Hadoop本地模式只是用于本地开发调试，或者快速安装体验Hadoop，这部分做简单的介绍。</p>

<h2 id="第三部分hadoop伪分布式模式安装">第三部分：Hadoop伪分布式模式安装</h2>
<p>学习Hadoop一般是在伪分布式模式下进行。这种模式是在一台机器上各个进程上运行Hadoop的各个模块，伪分布式的意思是虽然各个模块是在各个进程上分开运行的，但是只是运行在一个操作系统上的，并不是真正的分布式。</p>

<h2 id="第四部分完全分布式安装">第四部分：完全分布式安装</h2>
<p>完全分布式模式才是生产环境采用的模式，Hadoop运行在服务器集群上，生产环境一般都会做HA，以实现高可用。</p>

<h2 id="第五部分hadoop-ha安装">第五部分：Hadoop HA安装</h2>
<p>HA是指高可用，为了解决Hadoop单点故障问题，生产环境一般都做HA部署。这部分介绍了如何配置Hadoop2.x的高可用，并简单介绍了HA的工作原理。 
安装过程中，会穿插简单介绍涉及到的知识。希望能对大家有所帮助。</p>

<p>第一部分：Linux环境安装
第一步、配置Vmware NAT网络
一、Vmware网络模式介绍</p>

<p>参考：http://blog.csdn.net/collection4u/article/details/14127671</p>

<p>二、NAT模式配置</p>

<p>NAT是网络地址转换，是在宿主机和虚拟机之间增加一个地址转换服务，负责外部和虚拟机之间的通讯转接和IP转换。</p>

<p>我们部署Hadoop集群，这里选择NAT模式，各个虚拟机通过NAT使用宿主机的IP来访问外网。</p>

<p>我们的要求是集群中的各个虚拟机有固定的IP、可以访问外网，所以进行如下设置：</p>

<p>1、 Vmware安装后，默认的NAT设置如下：</p>

<p>enter image description here</p>

<p>2、 默认的设置是启动DHCP服务的，NAT会自动给虚拟机分配IP，但是我们需要将各个机器的IP固定下来，所以要取消这个默认设置。</p>

<p>3、 为机器设置一个子网网段，默认是192.168.136网段，我们这里设置为100网段，将来各个虚拟机Ip就为 192.168.100.*。</p>

<p>4、 点击NAT设置按钮，打开对话框，可以修改网关地址和DNS地址。这里我们为NAT指定DNS地址。</p>

<p>enter image description here</p>

<p>5、 网关地址为当前网段里的.2地址，好像是固定的，我们不做修改，先记住网关地址就好了，后面会用到。
“\n\n\n\n”</p>

<p>第二步、安装Linux操作系统
三、Vmware上安装Linux系统</p>

<p>1、 文件菜单选择新建虚拟机</p>

<p>2、 选择经典类型安装，下一步。</p>

<p>3、 选择稍后安装操作系统，下一步。</p>

<p>4、 选择Linux系统，版本选择CentOS 64位。</p>

<p>enter image description here</p>

<p>5、 命名虚拟机，给虚拟机起个名字，将来显示在Vmware左侧。并选择Linux系统保存在宿主机的哪个目录下，应该一个虚拟机保存在一个目录下，不能多个虚拟机使用一个目录。</p>

<p>enter image description here</p>

<p>6、 指定磁盘容量，是指定分给Linux虚拟机多大的硬盘，默认20G就可以，下一步。</p>

<p>7、 点击自定义硬件，可以查看、修改虚拟机的硬件配置，这里我们不做修改。</p>

<p>8、 点击完成后，就创建了一个虚拟机，但是此时的虚拟机还是一个空壳，没有操作系统，接下来安装操作系统。</p>

<p>9、 点击编辑虚拟机设置，找到DVD，指定操作系统ISO文件所在位置。</p>

<p>enter image description here</p>

<p>10、 点击开启此虚拟机，选择第一个回车开始安装操作系统。</p>

<p>enter image description here</p>

<p>11、 设置root密码。</p>

<p>enter image description here</p>

<p>12、 选择Desktop，这样就会装一个Xwindow。</p>

<p>enter image description here</p>

<p>13、 先不添加普通用户，其他用默认的，就把Linux安装完毕了。</p>

<p>四、设置网络</p>

<p>因为Vmware的NAT设置中关闭了DHCP自动分配IP功能，所以Linux还没有IP，需要我们设置网络各个参数。</p>

<p>1、 用root进入Xwindow，右击右上角的网络连接图标，选择修改连接。</p>

<p>enter image description here</p>

<p>2、 网络连接里列出了当前Linux里所有的网卡，这里只有一个网卡System eth0，点击编辑。</p>

<p>enter image description here</p>

<p>3、 配置IP、子网掩码、网关（和NAT设置的一样）、DNS等参数，因为NAT里设置网段为100.*，所以这台机器可以设置为192.168.100.10网关和NAT一致，为192.168.100.2</p>

<p>enter image description here</p>

<p>4、 用ping来检查是否可以连接外网，如下图，已经连接成功。</p>

<p>enter image description here</p>

<p>五、修改Hostname</p>

<p>1、 临时修改hostname</p>

<p>[root@localhost Desktop]# hostname bigdata-senior01.chybinmy.com
1
这种修改方式，系统重启后就会失效。</p>

<p>2、 永久修改hostname</p>

<p>想永久修改，应该修改配置文件 /etc/sysconfig/network。</p>

<p>命令：[root@bigdata-senior01 ~] vim /etc/sysconfig/network
1
打开文件后，</p>

<p>NETWORKING=yes  #使用网络
HOSTNAME=bigdata-senior01.chybinmy.com  #设置主机名
1
2
六、配置Host</p>

<p>命令：[root@bigdata-senior01 ~] vim /etc/hosts
添加hosts: 192.168.100.10 bigdata-senior01.chybinmy.com
1
2
七、关闭防火墙</p>

<p>学习环境可以直接把防火墙关闭掉。</p>

<p>(1) 用root用户登录后，执行查看防火墙状态。</p>

<p>[root@bigdata-senior01 hadoop]# service iptables status
1
(2) 用[root@bigdata-senior01 hadoop]# service iptables stop关闭防火墙，这个是临时关闭防火墙。</p>

<p>[root@bigdata-senior01 hadoop-2.5.0]# service iptables stop
iptables: Setting chains to policy ACCEPT: filter          [  OK  ]
iptables: Flushing firewall rules:                         [  OK  ]
iptables: Unloading modules:                               [  OK  ]
1
2
3
4
(3) 如果要永久关闭防火墙用。</p>

<p>[root@bigdata-senior01 hadoop]# chkconfig iptables off
1
关闭，这种需要重启才能生效。</p>

<p>八、关闭selinux</p>

<p>selinux是Linux一个子安全机制，学习环境可以将它禁用。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim /etc/sysconfig/selinux
1
 This file controls the state of SELinux on the system.
 SELINUX= can take one of these three values:
     enforcing - SELinux security policy is enforced.
     permissive - SELinux prints warnings instead of enforcing.
     disabled - No SELinux policy is loaded.
SELINUX=disabled
 SELINUXTYPE= can take one of these two values:
    targeted - Targeted processes are protected,
    mls - Multi Level Security protection.
SELINUXTYPE=targeted
1
2
3
4
5
6
7
8
9
10
enter image description here</p>

<h2 id="第三步安装jdk">第三步、安装JDK</h2>
<p>九、安装Java JDK</p>

<p>1、 查看是否已经安装了java JDK。</p>

<p>[root@bigdata-senior01 Desktop]# java –version
1
注意：Hadoop机器上的JDK，最好是Oracle的Java JDK，不然会有一些问题，比如可能没有JPS命令。 
如果安装了其他版本的JDK，卸载掉。</p>

<p>2、 安装java JDK</p>

<p>(1) 去下载Oracle版本Java JDK：jdk-7u67-linux-x64.tar.gz</p>

<p>(2) 将jdk-7u67-linux-x64.tar.gz解压到/opt/modules目录下</p>

<p>[root@bigdata-senior01 /]# tar -zxvf jdk-7u67-linux-x64.tar.gz -C /opt/modules
1
(3) 添加环境变量</p>

<p>设置JDK的环境变量 JAVA_HOME。需要修改配置文件/etc/profile，追加</p>

<p>export JAVA_HOME=”/opt/modules/jdk1.7.0_67”
export PATH=$JAVA_HOME/bin:$PATH
1
2
修改完毕后，执行 source /etc/profile</p>

<p>(4)安装后再次执行 java –version,可以看见已经安装完成。</p>

<p>[root@bigdata-senior01 /]# java -version
java version “1.7.0_67”
Java(TM) SE Runtime Environment (build 1.7.0_67-b01)
Java HotSpot(TM) 64-Bit Server VM (build 24.65-b04, mixed mode)
1
2
3
4</p>
<h2 id="第二部分hadoop本地模式安装-1">第二部分：Hadoop本地模式安装</h2>
<h2 id="第四步hadoop部署模式">第四步、Hadoop部署模式</h2>
<p>Hadoop部署模式有：本地模式、伪分布模式、完全分布式模式、HA完全分布式模式。</p>

<p>区分的依据是NameNode、DataNode、ResourceManager、NodeManager等模块运行在几个JVM进程、几个机器。</p>

<p>模式名称	各个模块占用的JVM进程数	各个模块运行在几个机器数上
本地模式	1个	1个
伪分布式模式	N个	1个
完全分布式模式	N个	N个
HA完全分布式	N个	N个</p>
<h2 id="第五步本地模式部署">第五步、本地模式部署</h2>
<p>十、本地模式介绍</p>

<p>本地模式是最简单的模式，所有模块都运行与一个JVM进程中，使用的本地文件系统，而不是HDFS，本地模式主要是用于本地开发过程中的运行调试用。下载hadoop安装包后不用任何设置，默认的就是本地模式。</p>

<p>十一、解压hadoop后就是直接可以使用</p>

<p>1、 创建一个存放本地模式hadoop的目录</p>

<p>[hadoop@bigdata-senior01 modules]$ mkdir /opt/modules/hadoopstandalone
1
2、 解压hadoop文件</p>

<p>[hadoop@bigdata-senior01 modules]$ tar -zxf /opt/sofeware/hadoop-2.5.0.tar.gz  -C /opt/modules/hadoopstandalone/
1
3、 确保JAVA_HOME环境变量已经配置好</p>

<p>[hadoop@bigdata-senior01 modules]$ echo ${JAVA_HOME}
/opt/modules/jdk1.7.0_67
1
2
十二、运行MapReduce程序，验证</p>

<p>我们这里用hadoop自带的wordcount例子来在本地模式下测试跑mapreduce。</p>

<p>1、 准备mapreduce输入文件wc.input</p>

<p>[hadoop@bigdata-senior01 modules]$ cat /opt/data/wc.input
hadoop mapreduce hive
hbase spark storm
sqoop hadoop hive
spark hadoop
1
2
3
4
5
2、 运行hadoop自带的mapreduce Demo</p>

<p>[hadoop@bigdata-senior01 hadoopstandalone]$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.5.0.jar wordcount /opt/data/wc.input output2
1
enter image description here</p>

<p>这里可以看到job ID中有local字样，说明是运行在本地模式下的。</p>

<p>3、 查看输出文件</p>

<p>本地模式下，mapreduce的输出是输出到本地。</p>

<p>[hadoop@bigdata-senior01 hadoopstandalone]$ ll output2
total 4
-rw-r–r– 1 hadoop hadoop 60 Jul  7 12:50 part-r-00000
-rw-r–r– 1 hadoop hadoop  0 Jul  7 12:50 _SUCCESS
1
2
3
4
输出目录中有_SUCCESS文件说明JOB运行成功，part-r-00000是输出结果文件。 
 </p>

<h2 id="第三部分hadoop伪分布式模式安装-1">第三部分：Hadoop伪分布式模式安装</h2>
<h2 id="第六步伪分布式hadoop部署过程">第六步、伪分布式Hadoop部署过程</h2>
<p>十三、Hadoop所用的用户设置</p>

<p>1、 创建一个名字为hadoop的普通用户</p>

<p>[root@bigdata-senior01 ~]# useradd hadoop
[root@bigdata-senior01 ~]# passwd hadoop
1
2
2、 给hadoop用户sudo权限</p>

<p>[root@bigdata-senior01 ~]# vim /etc/sudoers
1
设置权限，学习环境可以将hadoop用户的权限设置的大一些，但是生产环境一定要注意普通用户的权限限制。</p>

<p>root    ALL=(ALL)       ALL
hadoop ALL=(root) NOPASSWD:ALL
1
2
注意：如果root用户无权修改sudoers文件，先手动为root用户添加写权限。</p>

<p>[root@bigdata-senior01 ~]# chmod u+w /etc/sudoers
1
3、 切换到hadoop用户</p>

<p>[root@bigdata-senior01 ~]# su - hadoop
[hadoop@bigdata-senior01 ~]$
1
2
4、 创建存放hadoop文件的目录</p>

<p>[hadoop@bigdata-senior01 ~]$ sudo mkdir /opt/modules
1
5、 将hadoop文件夹的所有者指定为hadoop用户</p>

<p>如果存放hadoop的目录的所有者不是hadoop，之后hadoop运行中可能会有权限问题，那么就讲所有者改为hadoop。</p>

<p>[hadoop@bigdata-senior01 ~]# sudo chown -R hadoop:hadoop /opt/modules
1
十四、解压Hadoop目录文件</p>

<p>1、 复制hadoop-2.5.0.tar.gz到/opt/modules目录下。</p>

<p>2、 解压hadoop-2.5.0.tar.gz</p>

<p>[hadoop@bigdata-senior01 ~]# cd /opt/modules
[hadoop@bigdata-senior01 hadoop]# tar -zxvf hadoop-2.5.0.tar.gz
1
2
十五、配置Hadoop</p>

<p>1、 配置Hadoop环境变量</p>

<p>[hadoop@bigdata-senior01 hadoop]# vim /etc/profile
1
追加配置：</p>

<p>export HADOOP_HOME=”/opt/modules/hadoop-2.5.0”
export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH
1
2
执行：source /etc/profile 使得配置生效</p>

<p>验证HADOOP_HOME参数：</p>

<p>[hadoop@bigdata-senior01 /]$ echo $HADOOP_HOME
/opt/modules/hadoop-2.5.0
1
2
2、 配置 hadoop-env.sh、mapred-env.sh、yarn-env.sh文件的JAVA_HOME参数</p>

<p>[hadoop@bigdata-senior01 ~]$ sudo vim  ${HADOOP_HOME}/etc/hadoop/hadoop-env.sh
1
修改JAVA_HOME参数为：
export JAVA_HOME=”/opt/modules/jdk1.7.0_67”
1
2
3、 配置core-site.xml</p>

<p>enter image description here</p>

<p>[hadoop@bigdata-senior01 ~]{HADOOP_HOME}/etc/hadoop/core-site.xml</p>

<p>（1） fs.defaultFS参数配置的是HDFS的地址。</p>

<property>
<name>fs.defaultFS</name>
<value>hdfs://bigdata-senior01.chybinmy.com:8020</value>
</property>
<p>1
2
3
4
（2） hadoop.tmp.dir配置的是Hadoop临时目录，比如HDFS的NameNode数据默认都存放这个目录下，查看*-default.xml等默认配置文件，就可以看到很多依赖${hadoop.tmp.dir}的配置。</p>

<p>默认的hadoop.tmp.dir是/tmp/hadoop-${user.name},此时有个问题就是NameNode会将HDFS的元数据存储在这个/tmp目录下，如果操作系统重启了，系统会清空/tmp目录下的东西，导致NameNode元数据丢失，是个非常严重的问题，所有我们应该修改这个路径。</p>

<p>创建临时目录：
    [hadoop@bigdata-senior01 hadoop-2.5.0]$ sudo mkdir -p /opt/data/tmp
1
将临时目录的所有者修改为hadoop
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sudo chown –R hadoop:hadoop /opt/data/tmp
1
修改hadoop.tmp.dir</p>
<property>
   <name>hadoop.tmp.dir</name>
    <value>/opt/data/tmp</value>
  </property>
<p>1
2
3
4
十六、配置、格式化、启动HDFS</p>

<p>1、 配置hdfs-site.xml</p>

<p>enter image description here</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim ${HADOOP_HOME}/etc/hadoop/hdfs-site.xml
1
    <property>
       <name>dfs.replication</name>
       <value>1</value>
    </property>
1
2
3
4
dfs.replication配置的是HDFS存储时的备份数量，因为这里是伪分布式环境只有一个节点，所以这里设置为1。</p>

<p>2、 格式化HDFS</p>

<p>enter image description here</p>

<p>[hadoop@bigdata-senior01 ~]$ hdfs namenode –format
1
格式化是对HDFS这个分布式文件系统中的DataNode进行分块，统计所有分块后的初始元数据的存储在NameNode中。</p>

<p>格式化后，查看core-site.xml里hadoop.tmp.dir（本例是/opt/data目录）指定的目录下是否有了dfs目录，如果有，说明格式化成功。</p>

<p>注意：</p>

<p>格式化时，这里注意hadoop.tmp.dir目录的权限问题，应该hadoop普通用户有读写权限才行，可以将/opt/data的所有者改为hadoop。 
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sudo chown -R hadoop:hadoop /opt/data</p>

<p>查看NameNode格式化后的目录。</p>

<p>[hadoop@bigdata-senior01 ~]$ ll /opt/data/tmp/dfs/name/current
1
enter image description here</p>

<p>fsimage是NameNode元数据在内存满了后，持久化保存到的文件。</p>

<p>fsimage*.md5 是校验文件，用于校验fsimage的完整性。</p>

<p>seen_txid 是hadoop的版本</p>

<p>vession文件里保存：</p>

<p>namespaceID：NameNode的唯一ID。</p>

<p>clusterID:集群ID，NameNode和DataNode的集群ID应该一致，表明是一个集群。</p>

<p>#Mon Jul 04 17:25:50 CST 2016
namespaceID=2101579007
clusterID=CID-205277e6-493b-4601-8e33-c09d1d23ece4
cTime=0
storageType=NAME_NODE
blockpoolID=BP-1641019026-127.0.0.1-1467624350057
layoutVersion=-57
1
2
3
4
5
6
7
3、 启动NameNode</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/sbin/hadoop-daemon.sh start namenode
starting namenode, logging to /opt/modules/hadoop-2.5.0/logs/hadoop-hadoop-namenode-bigdata-senior01.chybinmy.com.out
1
2
enter image description here</p>

<p>4、 启动DataNode</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/sbin/hadoop-daemon.sh start datanode
starting datanode, logging to /opt/modules/hadoop-2.5.0/logs/hadoop-hadoop-datanode-bigdata-senior01.chybinmy.com.out
1
2
enter image description here</p>

<p>5、 启动SecondaryNameNode</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/sbin/hadoop-daemon.sh start secondarynamenode
starting secondarynamenode, logging to /opt/modules/hadoop-2.5.0/logs/hadoop-hadoop-secondarynamenode-bigdata-senior01.chybinmy.com.out
1
2
enter image description here</p>

<p>6、 JPS命令查看是否已经启动成功，有结果就是启动成功了。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ jps
3034 NameNode
3233 Jps
3193 SecondaryNameNode
3110 DataNode
1
2
3
4
5
enter image description here</p>

<p>7、 HDFS上测试创建目录、上传、下载文件</p>

<p>HDFS上创建目录</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/bin/hdfs dfs -mkdir /demo1
1
上传本地文件到HDFS上</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/bin/hdfs dfs -put 
${HADOOP_HOME}/etc/hadoop/core-site.xml /demo1
1
2
读取HDFS上的文件内容</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/bin/hdfs dfs -cat /demo1/core-site.xml
1
enter image description here</p>

<p>从HDFS上下载文件到本地</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -get /demo1/core-site.xml
1
enter image description here</p>

<p>十七、配置、启动YARN
1、 配置mapred-site.xml</p>

<p>默认没有mapred-site.xml文件，但是有个mapred-site.xml.template配置模板文件。复制模板生成mapred-site.xml。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]# cp etc/hadoop/mapred-site.xml.template etc/hadoop/mapred-site.xml
1
添加配置如下：</p>

<property>
<name>mapreduce.framework.name</name>
<value>yarn</value>
</property>
<p>1
2
3
4
指定mapreduce运行在yarn框架上。</p>

<p>enter image description here</p>

<p>2、 配置yarn-site.xml</p>

<p>添加配置如下：</p>

<property>
  <name>yarn.nodemanager.aux-services</name>
  <value>mapreduce_shuffle</value>
</property>
<property>
    <name>yarn.resourcemanager.hostname</name>
    <value>bigdata-senior01.chybinmy.com</value>
 </property>
<p>1
2
3
4
5
6
7
8
yarn.nodemanager.aux-services配置了yarn的默认混洗方式，选择为mapreduce的默认混洗算法。</p>

<p>yarn.resourcemanager.hostname指定了Resourcemanager运行在哪个节点上。</p>

<p>enter image description here</p>

<p>3、 启动Resourcemanager</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/sbin/yarn-daemon.sh start resourcemanager
1
enter image description here</p>

<p>4、 启动nodemanager</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ${HADOOP_HOME}/sbin/yarn-daemon.sh start nodemanager
1
enter image description here</p>

<p>5、 查看是否启动成功</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ jps
3034 NameNode
4439 NodeManager
4197 ResourceManager
4543 Jps
3193 SecondaryNameNode
3110 DataNode
1
2
3
4
5
6
7
可以看到ResourceManager、NodeManager已经启动成功了。</p>

<p>enter image description here</p>

<p>6、 YARN的Web页面</p>

<p>YARN的Web客户端端口号是8088，通过http://192.168.100.10:8088/可以查看。</p>

<p>enter image description here</p>

<p>十八、运行MapReduce Job</p>

<p>在Hadoop的share目录里，自带了一些jar包，里面带有一些mapreduce实例小例子，位置在share/hadoop/mapreduce/hadoop-mapreduce-examples-2.5.0.jar，可以运行这些例子体验刚搭建好的Hadoop平台，我们这里来运行最经典的WordCount实例。</p>

<p>1、 创建测试用的Input文件</p>

<p>创建输入目录:</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -mkdir -p /wordcountdemo/input
1
创建原始文件:</p>

<p>在本地/opt/data目录创建一个文件wc.input,内容如下。</p>

<p>enter image description here</p>

<p>将wc.input文件上传到HDFS的/wordcountdemo/input目录中:</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -put /opt/data/wc.input /wordcountdemo/input
1
enter image description here</p>

<p>2、 运行WordCount MapReduce Job</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/yarn jar share/hadoop/mapreduce/hadoop-mapreduce-examples-
2.5.0.jar wordcount /wordcountdemo/input /wordcountdemo/output
1
2
enter image description here</p>

<p>3、 查看输出结果目录</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -ls /wordcountdemo/output
-rw-r–r–   1 hadoop supergroup          0 2016-07-05 05:12 /wordcountdemo/output/_SUCCESS
-rw-r–r–   1 hadoop supergroup         60 2016-07-05 05:12 /wordcountdemo/output/part-r-00000
1
2
3
enter image description here</p>

<p>output目录中有两个文件，_SUCCESS文件是空文件，有这个文件说明Job执行成功。</p>

<p>part-r-00000文件是结果文件，其中-r-说明这个文件是Reduce阶段产生的结果，mapreduce程序执行时，可以没有reduce阶段，但是肯定会有map阶段，如果没有reduce阶段这个地方有是-m-。</p>

<p>一个reduce会产生一个part-r-开头的文件。</p>

<p>查看输出文件内容。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -cat /wordcountdemo/output/part-r-00000
hadoop  3
hbase   1
hive    2
mapreduce       1
spark   2
sqoop   1
storm   1
1
2
3
4
5
6
7
8
结果是按照键值排好序的。</p>

<p>十九、停止Hadoop</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop namenode
stopping namenode
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop datanode
stopping datanode
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/yarn-daemon.sh stop resourcemanager
stopping resourcemanager
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/yarn-daemon.sh stop nodemanager
stopping nodemanager
1
2
3
4
5
6
7
8
enter image description here</p>

<p>二十、 Hadoop各个功能模块的理解</p>

<p>1、 HDFS模块</p>

<p>HDFS负责大数据的存储，通过将大文件分块后进行分布式存储方式，突破了服务器硬盘大小的限制，解决了单台机器无法存储大文件的问题，HDFS是个相对独立的模块，可以为YARN提供服务，也可以为HBase等其他模块提供服务。</p>

<p>2、 YARN模块</p>

<p>YARN是一个通用的资源协同和任务调度框架，是为了解决Hadoop1.x中MapReduce里NameNode负载太大和其他问题而创建的一个框架。</p>

<p>YARN是个通用框架，不止可以运行MapReduce，还可以运行Spark、Storm等其他计算框架。</p>

<p>3、 MapReduce模块</p>

<p>MapReduce是一个计算框架，它给出了一种数据处理的方式，即通过Map阶段、Reduce阶段来分布式地流式处理数据。它只适用于大数据的离线处理，对实时性要求很高的应用不适用。</p>

<h2 id="第七步开启历史服务">第七步、开启历史服务</h2>
<p>二十一、历史服务介绍</p>

<p>Hadoop开启历史服务可以在web页面上查看Yarn上执行job情况的详细信息。可以通过历史服务器查看已经运行完的Mapreduce作业记录，比如用了多少个Map、用了多少个Reduce、作业提交时间、作业启动时间、作业完成时间等信息。</p>

<p>二十二、开启历史服务</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/mr-jobhistory-daemon.sh start historyserver、
1
开启后，可以通过Web页面查看历史服务器：</p>

<p>http://bigdata-senior01.chybinmy.com:19888/</p>

<p>二十三、Web查看job执行历史</p>

<p>1、 运行一个mapreduce任务</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/yarn jar share/hadoop/mapreduce/hadoop-mapreduce-examples-
2.5.0.jar wordcount /wordcountdemo/input /wordcountdemo/output1
1
2
2、 job执行中</p>

<p>enter image description here</p>

<p>3、 查看job历史</p>

<p>enter image description here</p>

<p>enter image description here</p>

<p>历史服务器的Web端口默认是19888，可以查看Web界面。</p>

<p>但是在上面所显示的某一个Job任务页面的最下面，Map和Reduce个数的链接上，点击进入Map的详细信息页面，再查看某一个Map或者Reduce的详细日志是看不到的，是因为没有开启日志聚集服务。</p>

<p>二十四、开启日志聚集</p>

<p>4、 日志聚集介绍</p>

<p>MapReduce是在各个机器上运行的，在运行过程中产生的日志存在于各个机器上，为了能够统一查看各个机器的运行日志，将日志集中存放在HDFS上，这个过程就是日志聚集。</p>

<p>5、 开启日志聚集</p>

<p>配置日志聚集功能：</p>

<p>Hadoop默认是不启用日志聚集的。在yarn-site.xml文件里配置启用日志聚集。</p>

<property>
    <name>yarn.log-aggregation-enable</name>
    <value>true</value>
 </property>
<property>
    <name>yarn.log-aggregation.retain-seconds</name>
    <value>106800</value>
 </property>
<p>1
2
3
4
5
6
7
8
yarn.log-aggregation-enable:是否启用日志聚集功能。</p>

<p>yarn.log-aggregation.retain-seconds：设置日志保留时间，单位是秒。</p>

<p>将配置文件分发到其他节点：</p>

<p>[hadoop@bigdata-senior01 hadoop]$ scp /opt/modules/hadoop-2.5.0/etc/hadoop/yarn-site.xml bigdata-senior02.chybinmy.com:/opt/modules/hadoop-2.5.0/etc/hadoop/
[hadoop@bigdata-senior01 hadoop]$ scp /opt/modules/hadoop-2.5.0/etc/hadoop/yarn-site.xml bigdata-senior03.chybinmy.com:/opt/modules/hadoop-2.5.0/etc/hadoop/
1
2
重启Yarn进程：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/stop-yarn.sh
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/start-yarn.sh
1
2
重启HistoryServer进程：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/mr-jobhistory-daemon.sh stop historyserver
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/mr-jobhistory-daemon.sh start historyserver
1
2
6、 测试日志聚集</p>

<p>运行一个demo MapReduce，使之产生日志：</p>

<p>bin/yarn jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.5.0.jar wordcount /input /output1
1
查看日志：</p>

<p>运行Job后，就可以在历史服务器Web页面查看各个Map和Reduce的日志了。 
 </p>

<p>第四部分：完全分布式安装
第八步、完全布式环境部署Hadoop
完全分部式是真正利用多台Linux主机来进行部署Hadoop，对Linux机器集群进行规划，使得Hadoop各个模块分别部署在不同的多台机器上。</p>

<p>二十五、环境准备</p>

<p>1、 克隆虚拟机</p>

<p>Vmware左侧选中要克隆的机器，这里对原有的BigData01机器进行克隆，虚拟机菜单中，选中管理菜单下的克隆命令。</p>

<p>选择“创建完整克隆”，虚拟机名称为BigData02，选择虚拟机文件保存路径，进行克隆。</p>

<p>再次克隆一个名为BigData03的虚拟机。</p>

<p>2、 配置网络</p>

<p>修改网卡名称：</p>

<p>在BigData02和BigData03机器上编辑网卡信息。执行sudo vim /etc/udev/rules.d/70-persistent-net.rules命令。因为是从BigData01机器克隆来的，所以会保留BigData01的网卡eth0，并且再添加一个网卡eth1。并且eth0的Mac地址和BigData01的地址是一样的，Mac地址不允许相同，所以要删除eth0，只保留eth1网卡，并且要将eth1改名为eth0。将修改后的eth0的mac地址复制下来，修改network-scripts文件中的HWADDR属性。</p>

<p>sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0
1
enter image description here</p>

<p>修改网络参数：</p>

<p>BigData02机器IP改为192.168.100.12</p>

<p>BigData03机器IP改为192.168.100.13</p>

<p>3、 配置Hostname</p>

<p>BigData02配置hostname为 bigdata-senior02.chybinmy.com</p>

<p>BigData03配置hostname为 bigdata-senior03.chybinmy.com</p>

<p>4、 配置hosts</p>

<p>BigData01、BigData02、BigData03三台机器hosts都配置为：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sudo vim /etc/hosts
192.168.100.10 bigdata-senior01.chybinmy.com
192.168.100.12 bigdata-senior02.chybinmy.com
192.168.100.13 bigdata-senior03.chybinmy.com
1
2
3
4
5、 配置Windows上的SSH客户端</p>

<p>在本地Windows中的SSH客户端上添加对BigData02、BigData03机器的SSH链接。</p>

<p>二十六、服务器功能规划</p>

<p>bigdata-senior01.chybinmy.com	bigdata-senior02.chybinmy.com	bigdata-senior03.chybinmy.com
NameNode	ResourceManage	 
DataNode	DataNode	DataNode
NodeManager	NodeManager	NodeManager
HistoryServer	 	SecondaryNameNode
二十七、在第一台机器上安装新的Hadoop</p>

<p>为了和之前BigData01机器上安装伪分布式Hadoop区分开来，我们将BigData01上的Hadoop服务都停止掉，然后在一个新的目录/opt/modules/app下安装另外一个Hadoop。 
我们采用先在第一台机器上解压、配置Hadoop，然后再分发到其他两台机器上的方式来安装集群。</p>

<p>6、 解压Hadoop目录：</p>

<p>[hadoop@bigdata-senior01 modules]$ tar -zxf /opt/sofeware/hadoop-2.5.0.tar.gz -C /opt/modules/app/
1
7、 配置Hadoop JDK路径修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件中的JDK路径：</p>

<p>export JAVA_HOME=”/opt/modules/jdk1.7.0_67”
1
8、 配置core-site.xml</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim etc/hadoop/core-site.xml
1</p>
<configuration>
 <property>
   <name>fs.defaultFS</name>
   <value>hdfs://bigdata-senior01.chybinmy.com:8020</value>
 </property>
 <property>
   <name>hadoop.tmp.dir</name>
   <value>/opt/modules/app/hadoop-2.5.0/data/tmp</value>
 </property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
fs.defaultFS为NameNode的地址。</p>

<p>hadoop.tmp.dir为hadoop临时目录的地址，默认情况下，NameNode和DataNode的数据文件都会存在这个目录下的对应子目录下。应该保证此目录是存在的，如果不存在，先创建。</p>

<p>9、 配置hdfs-site.xml</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim etc/hadoop/hdfs-site.xml
1</p>
<configuration>
 <property>
   <name>dfs.namenode.secondary.http-address</name>
   <value>bigdata-senior03.chybinmy.com:50090</value>
 </property>
</configuration>
<p>1
2
3
4
5
6
dfs.namenode.secondary.http-address是指定secondaryNameNode的http访问地址和端口号，因为在规划中，我们将BigData03规划为SecondaryNameNode服务器。</p>

<p>所以这里设置为：bigdata-senior03.chybinmy.com:50090</p>

<p>10、 配置slaves</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim etc/hadoop/slaves
bigdata-senior01.chybinmy.com
bigdata-senior02.chybinmy.com
bigdata-senior03.chybinmy.com
1
2
3
4
slaves文件是指定HDFS上有哪些DataNode节点。</p>

<p>11、 配置yarn-site.xml</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim etc/hadoop/yarn-site.xml
1
    <property>
        <name>yarn.nodemanager.aux-services</name>
        <value>mapreduce_shuffle</value>
    </property>
    <property>
        <name>yarn.resourcemanager.hostname</name>
        <value>bigdata-senior02.chybinmy.com</value>
    </property>
    <property>
        <name>yarn.log-aggregation-enable</name>
        <value>true</value>
    </property>
    <property>
        <name>yarn.log-aggregation.retain-seconds</name>
        <value>106800</value>
    </property>
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
根据规划yarn.resourcemanager.hostname这个指定resourcemanager服务器指向bigdata-senior02.chybinmy.com。</p>

<p>yarn.log-aggregation-enable是配置是否启用日志聚集功能。</p>

<p>yarn.log-aggregation.retain-seconds是配置聚集的日志在HDFS上最多保存多长时间。</p>

<p>12、 配置mapred-site.xml</p>

<p>从mapred-site.xml.template复制一个mapred-site.xml文件。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ cp etc/hadoop/mapred-site.xml.template etc/hadoop/mapred-site.xml
1</p>
<configuration>
    <property>
        <name>mapreduce.framework.name</name>
        <value>yarn</value>
    </property>
    <property>
        <name>mapreduce.jobhistory.address</name>
        <value>bigdata-senior01.chybinmy.com:10020</value>
    </property>
    <property>
        <name>mapreduce.jobhistory.webapp.address</name>
        <value>bigdata-senior01.chybinmy.com:19888</value>
    </property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
mapreduce.framework.name设置mapreduce任务运行在yarn上。</p>

<p>mapreduce.jobhistory.address是设置mapreduce的历史服务器安装在BigData01机器上。</p>

<p>mapreduce.jobhistory.webapp.address是设置历史服务器的web页面地址和端口号。</p>

<p>二十八、设置SSH无密码登录</p>

<p>Hadoop集群中的各个机器间会相互地通过SSH访问，每次访问都输入密码是不现实的，所以要配置各个机器间的</p>

<p>SSH是无密码登录的。</p>

<p>1、 在BigData01上生成公钥</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ssh-keygen -t rsa
1
一路回车，都设置为默认值，然后再当前用户的Home目录下的.ssh目录中会生成公钥文件（id_rsa.pub）和私钥文件（id_rsa）。</p>

<p>2、 分发公钥</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ ssh-copy-id bigdata-senior01.chybinmy.com
[hadoop@bigdata-senior01 hadoop-2.5.0]$ ssh-copy-id bigdata-senior02.chybinmy.com
[hadoop@bigdata-senior01 hadoop-2.5.0]$ ssh-copy-id bigdata-senior03.chybinmy.com
1
2
3
3、 设置BigData02、BigData03到其他机器的无密钥登录</p>

<p>同样的在BigData02、BigData03上生成公钥和私钥后，将公钥分发到三台机器上。</p>

<p>二十九、分发Hadoop文件</p>

<p>1、 首先在其他两台机器上创建存放Hadoop的目录</p>

<p>[hadoop@bigdata-senior02 ~]$ mkdir /opt/modules/app
[hadoop@bigdata-senior03 ~]$ mkdir /opt/modules/app
1
2
2、 通过Scp分发</p>

<p>Hadoop根目录下的share/doc目录是存放的hadoop的文档，文件相当大，建议在分发之前将这个目录删除掉，可以节省硬盘空间并能提高分发的速度。</p>

<p>doc目录大小有1.6G。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ du -sh /opt/modules/app/hadoop-2.5.0/share/doc
1.6G    /opt/modules/app/hadoop-2.5.0/share/doc
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/app/hadoop-2.5.0/ bigdata-senior02.chybinmy.com:/opt/modules/app
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/app/hadoop-2.5.0/ bigdata-senior03.chybinmy.com:/opt/modules/app
1
2
3
4
三十、格式NameNode</p>

<p>在NameNode机器上执行格式化：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ /opt/modules/app/hadoop-2.5.0/bin/hdfs namenode –format
1
注意：</p>

<p>如果需要重新格式化NameNode,需要先将原来NameNode和DataNode下的文件全部删除，不然会报错，NameNode和DataNode所在目录是在core-site.xml中hadoop.tmp.dir、dfs.namenode.name.dir、dfs.datanode.data.dir属性配置的。</p>

<property>
     <name>hadoop.tmp.dir</name>
     <value>/opt/data/tmp</value>
  </property>
<property>
     <name>dfs.namenode.name.dir</name>
     <value>file://${hadoop.tmp.dir}/dfs/name</value>
  </property>
<property>
     <name>dfs.datanode.data.dir</name>
     <value>file://${hadoop.tmp.dir}/dfs/data</value>
  </property>
<p>1
2
3
4
5
6
7
8
9
10
11
12
因为每次格式化，默认是创建一个集群ID，并写入NameNode和DataNode的VERSION文件中（VERSION文件所在目录为dfs/name/current 和 dfs/data/current），重新格式化时，默认会生成一个新的集群ID,如果不删除原来的目录，会导致namenode中的VERSION文件中是新的集群ID,而DataNode中是旧的集群ID，不一致时会报错。</p>

<p>另一种方法是格式化时指定集群ID参数，指定为旧的集群ID。</p>

<p>三十一、启动集群</p>

<p>1、 启动HDFS</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ /opt/modules/app/hadoop-2.5.0/sbin/start-dfs.sh
1
enter image description here</p>

<p>2、 启动YARN</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ /opt/modules/app/hadoop-2.5.0/sbin/start-yarn.sh
1
在BigData02上启动ResourceManager:</p>

<p>[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/yarn-daemon.sh start resourcemanager
1
enter image description here</p>

<p>3、 启动日志服务器</p>

<p>因为我们规划的是在BigData03服务器上运行MapReduce日志服务，所以要在BigData03上启动。</p>

<p>[hadoop@bigdata-senior03 ~]$ /opt/modules/app/hadoop-2.5.0/sbin/mr-jobhistory-daemon.sh start historyserver
starting historyserver, logging to /opt/modules/app/hadoop-2.5.0/logs/mapred-hadoop-historyserver-bigda       ta-senior03.chybinmy.com.out
1
2
[hadoop@bigdata-senior03 ~]$ jps
3570 Jps
3537 JobHistoryServer
3310 SecondaryNameNode
3213 DataNode
3392 NodeManager
1
2
3
4
5
6
4、 查看HDFS Web页面</p>

<p>http://bigdata-senior01.chybinmy.com:50070/</p>

<p>5、 查看YARN Web 页面</p>

<p>http://bigdata-senior02.chybinmy.com:8088/cluster</p>

<p>三十二、测试Job</p>

<p>我们这里用hadoop自带的wordcount例子来在本地模式下测试跑mapreduce。</p>

<p>1、 准备mapreduce输入文件wc.input</p>

<p>[hadoop@bigdata-senior01 modules]$ cat /opt/data/wc.input
hadoop mapreduce hive
hbase spark storm
sqoop hadoop hive
spark hadoop
1
2
3
4
5
2、 在HDFS创建输入目录input</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -mkdir /input
1
3、 将wc.input上传到HDFS</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -put /opt/data/wc.input /input/wc.input
1
4、 运行hadoop自带的mapreduce Demo</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/yarn jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.5.0.jar wordcount /input/wc.input /output
1
enter image description here</p>

<p>5、 查看输出文件</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -ls /output
Found 2 items
-rw-r–r–   3 hadoop supergroup          0 2016-07-14 16:36 /output/_SUCCESS
-rw-r–r–   3 hadoop supergroup         60 2016-07-14 16:36 /output/part-r-00000
1
2
3
4
第五部分：Hadoop HA安装
HA的意思是High Availability高可用，指当当前工作中的机器宕机后，会自动处理这个异常，并将工作无缝地转移到其他备用机器上去，以来保证服务的高可用。</p>

<p>HA方式安装部署才是最常见的生产环境上的安装部署方式。Hadoop HA是Hadoop 2.x中新添加的特性，包括NameNode HA 和 ResourceManager HA。因为DataNode和NodeManager本身就是被设计为高可用的，所以不用对他们进行特殊的高可用处理。</p>

<p>第九步、时间服务器搭建</p>

<p>Hadoop对集群中各个机器的时间同步要求比较高，要求各个机器的系统时间不能相差太多，不然会造成很多问题。可以配置集群中各个机器和互联网的时间服务器进行时间同步，但是在实际生产环境中，集群中大部分服务器是不能连接外网的，这时候可以在内网搭建一个自己的时间服务器（NTP服务器），集群的各个机器与这个时间服务器进行时间同步。</p>

<p>三十三、配置NTP服务器</p>

<p>我们选择第三台机器（bigdata-senior03.chybinmy.com）为NTF服务器，其他机器和这台机器进行同步。</p>

<p>1、 检查ntp服务是否已经安装</p>

<p>[hadoop@bigdata-senior03 data]$ sudo rpm -qa | grep ntp
ntpdate-4.2.6p5-1.el6.centos.x86_64
ntp-4.2.6p5-1.el6.centos.x86_64
1
2
3
显示已经安装过了ntp程序，其中ntpdate-4.2.6p5-1.el6.centos.x86_64 是用来和某台服务器进行同步的，ntp-4.2.6p5-1.el6.centos.x86_64是用来提供时间同步服务的。</p>

<p>2、 修改配置文件ntp.conf</p>

<p>[hadoop@bigdata-senior03 data]$ vim /etc/ntp.conf
1
启用restrice,修改网段</p>

<p>restrict 192.168.100.0 mask 255.255.255.0 nomodify notrap 
将这行的注释去掉，并且将网段改为集群的网段，我们这里是100网段。</p>

<p>注释掉server域名配置</p>

<p>#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst
1
2
3
4
是时间服务器的域名，这里不需要连接互联网，所以将他们注释掉。</p>

<p>修改</p>

<p>server 127.127.1.0</p>

<p>fudge 127.127.1.0 stratum 10</p>

<p>3、 修改配置文件ntpd</p>

<p>[hadoop@bigdata-senior03 ~]$ sudo vim /etc/sysconfig/ntpd
1
添加一行配置：SYNC_CLOCK=yes</p>

<p>enter image description here</p>

<p>4、 启动ntp服务</p>

<p>[hadoop@bigdata-senior03 ~]$ sudo chkconfig ntpd on
1
这样每次机器启动时，ntp服务都会自动启动。</p>

<p>三十四、配置其他机器的同步</p>

<p>切换到root用户进行配置通过contab进行定时同步：</p>

<p>[root@bigdata-senior02 hadoop]# crontab -e 
*/10 * * * * /usr/sbin/ntpdate bigdata-senior03.chybinmy.com
[root@bigdata-senior02 hadoop]# crontab -e 
*/10 * * * * /usr/sbin/ntpdate bigdata-senior03.chybinmy.com
1
2
3
4
三十五、 测试同步是否有效</p>

<p>1、 查看目前三台机器的时间</p>

<p>[hadoop@bigdata-senior03 ~]$ date “+%Y-%m-%d %H:%M:%S”
2016-09-23 16:43:56
[hadoop@bigdata-senior02 ~]$ date “+%Y-%m-%d %H:%M:%S”
2016-09-23 16:44:08
[hadoop@bigdata-senior01 data]$ date “+%Y-%m-%d %H:%M:%S”
2016-09-23 16:44:18
1
2
3
4
5
6
2、 修改bigdata-senior01上的时间</p>

<p>将时间改为一个以前的时间：</p>

<p>[hadoop@bigdata-senior01 data]$ sudo date -s ‘2016-01-01 00:00:00’
Fri Jan  1 00:00:00 CST 2016
[hadoop@bigdata-senior01 data]$ date “+%Y-%m-%d %H:%M:%S”
2016-01-01 00:00:05
1
2
3
4
等10分钟，看是否可以实现自动同步，将bigdata-senior01上的时间修改为和bigdata-senior03上的一致。</p>

<p>3、 查看是否自动同步时间</p>

<p>[hadoop@bigdata-senior01 data]$ date “+%Y-%m-%d %H:%M:%S”
2016-09-23 16:54:36
1
2
可以看到bigdata-senior01上的时间已经实现自动同步了。</p>

<p>第十步、Zookeeper分布式机器部署
三十六、zookeeper说明</p>

<p>Zookeeper在Hadoop集群中的作用。</p>

<p>Zookeeper是分布式管理协作框架，Zookeeper集群用来保证Hadoop集群的高可用，（高可用的含义是：集群中就算有一部分服务器宕机，也能保证正常地对外提供服务。）</p>

<p>Zookeeper保证高可用的原理。</p>

<p>Zookeeper集群能够保证NamaNode服务高可用的原理是：Hadoop集群中有两个NameNode服务，两个NaameNode都定时地给Zookeeper发送心跳，告诉Zookeeper我还活着，可以提供服务，单某一个时间只有一个是Action状态，另外一个是Standby状态，一旦Zookeeper检测不到Action NameNode发送来的心跳后，就切换到Standby状态的NameNode上，将它设置为Action状态，所以集群中总有一个可用的NameNode，达到了NameNode的高可用目的。</p>

<p>Zookeeper的选举机制。</p>

<p>Zookeeper集群也能保证自身的高可用，保证自身高可用的原理是，Zookeeper集群中的各个机器分为Leader和Follower两个角色，写入数据时，要先写入Leader，Leader同意写入后，再通知Follower写入。客户端读取数时，因为数据都是一样的，可以从任意一台机器上读取数据。</p>

<p>这里Leader角色就存在单点故障的隐患，高可用就是解决单点故障隐患的。Zookeeper从机制上解决了Leader的单点故障问题，Leader是哪一台机器是不固定的，Leader是选举出来的。选举流程是，集群中任何一台机器发现集群中没有Leader时，就推荐自己为Leader，其他机器来同意，当超过一半数的机器同意它为Leader时，选举结束，所以Zookeeper集群中的机器数据必须是奇数。这样就算当Leader机器宕机后，会很快选举出新的Leader，保证了Zookeeper集群本身的高可用。</p>

<p>写入高可用。</p>

<p>集群中的写入操作都是先通知Leader，Leader再通知Follower写入，实际上当超过一半的机器写入成功后，就认为写入成功了，所以就算有些机器宕机，写入也是成功的。</p>

<p>读取高可用。</p>

<p>zookeeperk客户端读取数据时，可以读取集群中的任何一个机器。所以部分机器的宕机并不影响读取。</p>

<p>zookeeper服务器必须是奇数台，因为zookeeper有选举制度，角色有：领导者、跟随者、观察者，选举的目的是保证集群中数据的一致性。</p>

<p>三十七、安装zookeeper</p>

<p>我们这里在BigData01、BigData02、BigData03三台机器上安装zookeeper集群。</p>

<p>1、 解压安装包</p>

<p>在BigData01上安装解压zookeeper安装包。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ tar -zxf /opt/sofeware/zookeeper-3.4.8.tar.gz -C /opt/modules/
1
2、 修改配置</p>

<p>拷贝conf下的zoo_sample.cfg副本，改名为zoo.cfg。zoo.cfg是zookeeper的配置文件：</p>

<p>[hadoop@bigdata-senior01 zookeeper-3.4.8]$ cp conf/zoo_sample.cfg conf/zoo.cfg
1
dataDir属性设置zookeeper的数据文件存放的目录：</p>

<p>dataDir=/opt/modules/zookeeper-3.4.8/data/zData</p>

<p>指定zookeeper集群中各个机器的信息：</p>

<p>server.1=bigdata-senior01.chybinmy.com:2888:3888
server.2=bigdata-senior02.chybinmy.com:2888:3888
server.3=bigdata-senior03.chybinmy.com:2888:3888
1
2
3
server后面的数字范围是1到255，所以一个zookeeper集群最多可以有255个机器。</p>

<p>enter image description here</p>

<p>3、 创建myid文件</p>

<p>在dataDir所指定的目录下创一个名为myid的文件，文件内容为server点后面的数字。</p>

<p>enter image description here</p>

<p>4、 分发到其他机器</p>

<p>[hadoop@bigdata-senior01 zookeeper-3.4.8]$ scp -r /opt/modules/zookeeper-3.4.8 bigdata-senior02.chybinmy.com:/opt/modules
[hadoop@bigdata-senior01 zookeeper-3.4.8]$ scp -r /opt/modules/zookeeper-3.4.8 bigdata-senior03.chybinmy.com:/opt/modules
1
2
5、 修改其他机器上的myid文件</p>

<p>[hadoop@bigdata-senior02 zookeeper-3.4.8]$ echo 2 &gt; /opt/modules/zookeeper-3.4.8/data/zData/myid
[hadoop@bigdata-senior02 zookeeper-3.4.8]$ cat /opt/modules/zookeeper-3.4.8/data/zData/myid 
2
1
2
3
[hadoop@bigdata-senior03 ~]$ echo 3 &gt; /opt/modules/zookeeper-3.4.8/data/zData/myid
[hadoop@bigdata-senior03 ~]$ cat /opt/modules/zookeeper-3.4.8/data/zData/myid
3
1
2
3
6、 启动zookeeper</p>

<p>需要在各个机器上分别启动zookeeper。</p>

<p>[hadoop@bigdata-senior01 zookeeper-3.4.8]$ bin/zkServer.sh start
[hadoop@bigdata-senior02 zookeeper-3.4.8]$ bin/zkServer.sh start
[hadoop@bigdata-senior03 zookeeper-3.4.8]$ bin/zkServer.sh start
1
2
3
enter image description here</p>

<p>三十八、zookeeper命令</p>

<p>进入zookeeper Shell</p>

<p>在zookeeper根目录下执行 bin/zkCli.sh进入zk shell模式。</p>

<p>zookeeper很像一个小型的文件系统，/是根目录，下面的所有节点都叫zNode。</p>

<p>进入zk shell 后输入任意字符，可以列出所有的zookeeper命令</p>

<p>enter image description here</p>

<p>查询zNode上的数据：get /zookeeper</p>

<p>创建一个zNode : create /znode1 “demodata “</p>

<p>列出所有子zNode：ls /</p>

<p>enter image description here</p>

<p>删除znode : rmr /znode1</p>

<p>退出shell模式：quit</p>

<h2 id="第十一步hadoop-2x-hdfs-ha-部署">第十一步、Hadoop 2.x HDFS HA 部署</h2>
<p>三十九、HDFS HA原理</p>

<p>单NameNode的缺陷存在单点故障的问题，如果NameNode不可用，则会导致整个HDFS文件系统不可用。所以需要设计高可用的HDFS（Hadoop HA）来解决NameNode单点故障的问题。解决的方法是在HDFS集群中设置多个NameNode节点。但是一旦引入多个NameNode，就有一些问题需要解决。</p>

<p>HDFS HA需要保证的四个问题：</p>

<p>保证NameNode内存中元数据数据一致，并保证编辑日志文件的安全性。</p>

<p>多个NameNode如何协作</p>

<p>客户端如何能正确地访问到可用的那个NameNode。</p>

<p>怎么保证任意时刻只能有一个NameNode处于对外服务状态。</p>

<p>解决方法</p>

<p>对于保证NameNode元数据的一致性和编辑日志的安全性，采用Zookeeper来存储编辑日志文件。</p>

<p>两个NameNode一个是Active状态的，一个是Standby状态的，一个时间点只能有一个Active状态的 
NameNode提供服务,两个NameNode上存储的元数据是实时同步的，当Active的NameNode出现问题时，通过Zookeeper实时切换到Standby的NameNode上，并将Standby改为Active状态。</p>

<p>客户端通过连接一个Zookeeper的代理来确定当时哪个NameNode处于服务状态。</p>

<p>四十、HDFS HA架构图</p>

<p>enter image description here</p>

<p>HDFS HA架构中有两台NameNode节点，一台是处于活动状态（Active）为客户端提供服务，另外一台处于热备份状态（Standby）。</p>

<p>元数据文件有两个文件：fsimage和edits，备份元数据就是备份这两个文件。JournalNode用来实时从Active NameNode上拷贝edits文件，JournalNode有三台也是为了实现高可用。</p>

<p>Standby NameNode不对外提供元数据的访问，它从Active NameNode上拷贝fsimage文件，从JournalNode上拷贝edits文件，然后负责合并fsimage和edits文件，相当于SecondaryNameNode的作用。最终目的是保证Standby NameNode上的元数据信息和Active NameNode上的元数据信息一致，以实现热备份。</p>

<p>Zookeeper来保证在Active NameNode失效时及时将Standby NameNode修改为Active状态。</p>

<p>ZKFC（失效检测控制）是Hadoop里的一个Zookeeper客户端，在每一个NameNode节点上都启动一个ZKFC进程，来监控NameNode的状态，并把NameNode的状态信息汇报给Zookeeper集群，其实就是在Zookeeper上创建了一个Znode节点，节点里保存了NameNode状态信息。当NameNode失效后，ZKFC检测到报告给Zookeeper，Zookeeper把对应的Znode删除掉，Standby ZKFC发现没有Active状态的NameNode时，就会用shell命令将自己监控的NameNode改为Active状态，并修改Znode上的数据。 
Znode是个临时的节点，临时节点特征是客户端的连接断了后就会把znode删除，所以当ZKFC失效时，也会导致切换NameNode。</p>

<p>DataNode会将心跳信息和Block汇报信息同时发给两台NameNode，DataNode只接受Active NameNode发来的文件读写操作指令。</p>

<p>四十一、搭建HDFS HA 环境</p>

<p>1、 服务器角色规划</p>

<p>bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com
NameNode	NameNode	 
Zookeeper	Zookeeper	Zookeeper
DataNode	DataNode	DataNode
 	ResourceManage	ResourceManage
NodeManager	NodeManager	NodeManager
2、 创建HDFS HA 版本Hadoop程序目录</p>

<p>在bigdata01、bigdata02、bigdata03三台机器上分别创建目录/opt/modules/hadoopha/用来存放Hadoop HA环境。</p>

<p>[hadoop@bigdata-senior01 modules]$ mkdir /opt/modules/hadoopha
1
3、 新解压Hadoop 2.5.0</p>

<p>[hadoop@bigdata-senior01 ~]$ tar -zxf /opt/sofeware/hadoop-2.5.0.tar.gz -C /opt/modules/hadoopha/
1
4、 配置Hadoop JDK路径</p>

<p>修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件中的JDK路径
export JAVA_HOME=”/opt/modules/jdk1.7.0_67”
1
2
5、 配置hdfs-site.xml</p>

<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <property>
    <!-- 为namenode集群定义一个services name -->
    <name>dfs.nameservices</name>
    <value>ns1</value>
  </property>
  <property>
    <!-- nameservice 包含哪些namenode，为各个namenode起名 -->
    <name>dfs.ha.namenodes.ns1</name>
    <value>nn1,nn2</value>
  </property>
  <property>
    <!--  名为nn1的namenode 的rpc地址和端口号，rpc用来和datanode通讯 -->
    <name>dfs.namenode.rpc-address.ns1.nn1</name>
    <value>bigdata-senior01.chybinmy.com:8020</value>
  </property>
  <property>
    <!-- 名为nn2的namenode 的rpc地址和端口号，rpc用来和datanode通讯  -->
    <name>dfs.namenode.rpc-address.ns1.nn2</name>
    <value>bigdata-senior02.chybinmy.com:8020</value>
  </property>
  <property>
    <!--名为nn1的namenode 的http地址和端口号，web客户端 -->
    <name>dfs.namenode.http-address.ns1.nn1</name>
    <value>bigdata-senior01.chybinmy.com:50070</value>
  </property>
  <property>
    <!--名为nn2的namenode 的http地址和端口号，web客户端 -->
    <name>dfs.namenode.http-address.ns1.nn2</name>
    <value>bigdata-senior02.chybinmy.com:50070</value>
  </property>
  <property>
    <!--  namenode间用于共享编辑日志的journal节点列表 -->
    <name>dfs.namenode.shared.edits.dir</name>
    <value>qjournal://bigdata-senior01.chybinmy.com:8485;bigdata-senior02.chybinmy.com:8485;bigdata-senior03.chybinmy.com:8485/ns1</value>
  </property>
  <property>
    <!--  journalnode 上用于存放edits日志的目录 -->
    <name>dfs.journalnode.edits.dir</name>
    <value>/opt/modules/hadoopha/hadoop-2.5.0/tmp/data/dfs/jn</value>
  </property>
  <property>
    <!--  客户端连接可用状态的NameNode所用的代理类 -->
    <name>dfs.client.failover.proxy.provider.ns1</name>
    <value>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</value>
  </property>
  <property>
    <!--   -->
    <name>dfs.ha.fencing.methods</name>
    <value>sshfence</value>
  </property>
  <property>
    <name>dfs.ha.fencing.ssh.private-key-files</name>
    <value>/home/hadoop/.ssh/id_rsa</value>
  </property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
6、 配置core-site.xml</p>

<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <property>
    <!--  hdfs 地址，ha中是连接到nameservice -->
    <name>fs.defaultFS</name>
    <value>hdfs://ns1</value>
  </property>
  <property>
    <!--  -->
    <name>hadoop.tmp.dir</name>
    <value>/opt/modules/hadoopha/hadoop-2.5.0/data/tmp</value>
  </property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
hadoop.tmp.dir设置hadoop临时目录地址，默认时，NameNode和DataNode的数据存在这个路径下。</p>

<p>7、 配置slaves文件</p>

<p>bigdata-senior01.chybinmy.com
bigdata-senior02.chybinmy.com
bigdata-senior03.chybinmy.com
1
2
3
8、 分发到其他节点</p>

<p>分发之前先将share/doc目录删除，这个目录中是帮助文件，并且很大，可以删除。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/hadoopha bigdata-senior02.chybinmy.com:/opt/modules
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/hadoopha bigdata-senior03.chybinmy.com:/opt/modules
1
2
9、 启动HDFS HA集群</p>

<p>三台机器分别启动Journalnode。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start journalnode
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start journalnode
[hadoop@bigdata-senior03 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start journalnode
1
2
3
jps命令查看是否启动。</p>

<p>10、 启动Zookeeper</p>

<p>在三台节点上启动Zookeeper：</p>

<p>[hadoop@bigdata-senior01 zookeeper-3.4.8]$ bin/zkServer.sh start
[hadoop@bigdata-senior02 zookeeper-3.4.8]$ bin/zkServer.sh start
[hadoop@bigdata-senior03 zookeeper-3.4.8]$ bin/zkServer.sh start
1
2
3
11、 格式化NameNode</p>

<p>在第一台上进行NameNode格式化：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs namenode -format
1
在第二台NameNode上：</p>

<p>[hadoop@bigdata-senior02 hadoop-2.5.0]$ bin/hdfs namenode -bootstrapStandby
1
12、 启动NameNode</p>

<p>在第一台、第二台上启动NameNode：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start namenode
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start namenode
1
2
查看HDFS Web页面，此时两个NameNode都是standby状态。</p>

<p>切换第一台为active状态：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs haadmin -transitionToActive nn1
1
可以添加上forcemanual参数，强制将一个NameNode转换为Active状态。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs haadmin –transitionToActive -forcemanual nn1
1
此时从web 页面就看到第一台已经是active状态了。</p>

<p>enter image description here</p>

<p>13、 配置故障自动转移</p>

<p>利用zookeeper集群实现故障自动转移，在配置故障自动转移之前，要先关闭集群，不能在HDFS运行期间进行配置。</p>

<p>关闭NameNode、DataNode、JournalNode、zookeeper</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop namenode
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop datanode
[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop journalnode
[hadoop@bigdata-senior01 hadoop-2.5.0]$ cd ../../zookeeper-3.4.8/
[hadoop@bigdata-senior01 zookeeper-3.4.8]$ bin/zkServer.sh stop
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop namenode
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop datanode
[hadoop@bigdata- senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop journalnode
[hadoop@bigdata- senior02 hadoop-2.5.0]$ cd ../../zookeeper-3.4.8/
[hadoop@bigdata- senior02 zookeeper-3.4.8]$ bin/zkServer.sh stop
[hadoop@bigdata- senior03 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop datanode
[hadoop@bigdata- senior03 hadoop-2.5.0]$ sbin/hadoop-daemon.sh stop journalnode
[hadoop@bigdata- senior03 hadoop-2.5.0]$ cd ../../zookeeper-3.4.8/
[hadoop@bigdata- senior03 zookeeper-3.4.8]$ bin/zkServer.sh stop
1
2
3
4
5
6
7
8
9
10
11
12
13
14
修改hdfs-site.xml</p>

<property>
    <name>dfs.ha.automatic-failover.enabled</name>
    <value>true</value>
</property>
<p>1
2
3
4
修改core-site.xml</p>

<property>
   <name>ha.zookeeper.quorum</name>
   <value>bigdata-senior01.chybinmy.com:2181,bigdata-senior02.chybinmy.com:2181,bigdata-senior03.chybinmy.com:2181</value>
</property>
<p>1
2
3
4
将hdfs-site.xml和core-site.xml分发到其他机器</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/hdfs-site.xml bigdata-senior02.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/hdfs-site.xml bigdata-senior03.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/core-site.xml bigdata-senior02.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/core-site.xml bigdata-senior03.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/
1
2
3
4
启动zookeeper</p>

<p>三台机器启动zookeeper</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ /opt/modules/zookeeper-3.4.8/bin/zkServer.sh start
1
创建一个zNode</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ cd /opt/modules/hadoopha/hadoop-2.5.0/
[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs zkfc -formatZK
1
2
enter image description here</p>

<p>在Zookeeper上创建一个存储namenode相关的节点。</p>

<p>14、 启动HDFS、JournalNode、zkfc</p>

<p>启动NameNode、DataNode、JournalNode、zkfc</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/start-dfs.sh
1
zkfc只针对NameNode监听。</p>

<p>四十二、测试HDFS HA</p>

<p>1、 测试故障自动转移和数据是否共享</p>

<p>在nn1上上传文件</p>

<p>目前bigdata-senior01节点上的NameNode是Active状态的。</p>

<p>enter image description here</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -put /opt/data/wc.input /
1
enter image description here</p>

<p>将nn1上的NodeNode进程杀掉</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ kill -9 3364
1
nn1上的namenode已经无法访问了。</p>

<p>查看nn2是否是Active状态</p>

<p>enter image description here</p>

<p>在nn2上查看是否看见文件</p>

<p>enter image description here</p>

<p>经以上验证，已经实现了nn1和nn2之间的文件同步和故障自动转移。</p>

<h2 id="第十二步hadoop-2x-yarn-ha-部署">第十二步、Hadoop 2.x YARN HA 部署</h2>
<p>四十三、YARN HA原理</p>

<p>Hadoop2.4版本之前，ResourceManager也存在单点故障的问题，也需要实现HA来保证ResourceManger的高可也用性。</p>

<p>ResouceManager从记录着当前集群的资源分配情况和JOB的运行状态，YRAN HA 利用Zookeeper等共享存储介质来存储这些信息来达到高可用。另外利用Zookeeper来实现ResourceManager自动故障转移。</p>

<p>enter image description here</p>

<p>MasterHADaemon：控制RM的 Master的启动和停止，和RM运行在一个进程中，可以接收外部RPC命令。</p>

<p>共享存储：Active Master将信息写入共享存储，Standby Master读取共享存储信息以保持和Active Master同步。</p>

<p>ZKFailoverController：基于Zookeeper实现的切换控制器，由ActiveStandbyElector和HealthMonitor组成，ActiveStandbyElector负责与Zookeeper交互，判断所管理的Master是进入Active还是Standby；HealthMonitor负责监控Master的活动健康情况，是个监视器。</p>

<p>Zookeeper：核心功能是维护一把全局锁控制整个集群上只有一个Active的ResourceManager。</p>

<p>四十四、搭建YARN HA环境</p>

<p>1、 服务器角色规划</p>

<p>bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com
NameNode	NameNode	 
Zookeeper	Zookeeper	Zookeeper
DataNode	DataNode	DataNode
 	ResourceManage	ResourceManage
NodeManager	NodeManager	NodeManager
2、 修改配置文件yarn-site.xml</p>

<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
  </property>
  <property>
    <name>yarn.log-aggregation-enable</name>
    <value>true</value>
  </property>
  <property>
    <name>yarn.log-aggregation.retain-seconds</name>
    <value>106800</value>
  </property>
  <property>
    <!--  启用resourcemanager的ha功能 -->
    <name>yarn.resourcemanager.ha.enabled</name>
    <value>true</value>
  </property>
  <property>
    <!--  为resourcemanage ha 集群起个id -->
    <name>yarn.resourcemanager.cluster-id</name>
    <value>yarn-cluster</value>
  </property>
  <property>
    <!--  指定resourcemanger ha 有哪些节点名 -->
    <name>yarn.resourcemanager.ha.rm-ids</name>
    <value>rm12,rm13</value>
  </property>
  <property>
    <!--  指定第一个节点的所在机器 -->
    <name>yarn.resourcemanager.hostname.rm12</name>
    <value>bigdata-senior02.chybinmy.com</value>
  </property>
  <property>
    <!--  指定第二个节点所在机器 -->
    <name>yarn.resourcemanager.hostname.rm13</name>
    <value>bigdata-senior03.chybinmy.com</value>
  </property>
  <property>
    <!--  指定resourcemanger ha 所用的zookeeper 节点 -->
    <name>yarn.resourcemanager.zk-address</name>
    <value>bigdata-senior01.chybinmy.com:2181,bigdata-senior02.chybinmy.com:2181,bigdata-senior03.chybinmy.com:2181</value>
  </property>
  <property>
    <!--  -->
    <name>yarn.resourcemanager.recovery.enabled</name>
    <value>true</value>
  </property>
  <property>
    <!--  -->
    <name>yarn.resourcemanager.store.class</name>
    <value>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore</value>
  </property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
3、 分发到其他机器</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/yarn-site.xml bigdata-senior02.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp /opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/yarn-site.xml bigdata-senior03.chybinmy.com:/opt/modules/hadoopha/hadoop-2.5.0/etc/hadoop/\
1
2
4、 启动</p>

<p>在bigdata-senior01上启动yarn：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/start-yarn.sh
1
在bigdata-senior02、bigdata-senior03上启动resourcemanager：</p>

<p>[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/yarn-daemon.sh start resourcemanager
[hadoop@bigdata-senior03 hadoop-2.5.0]$ sbin/yarn-daemon.sh start resourcemanager
1
2
启动后各个节点的进程。</p>

<p>enter image description here</p>

<p>enter image description here</p>

<p>enter image description here</p>

<p>Web客户端访问bigdata02机器上的resourcemanager正常，它是active状态的。</p>

<p>http://bigdata-senior02.chybinmy.com:8088/cluster</p>

<p>访问另外一个resourcemanager，因为他是standby,会自动跳转到active的resourcemanager。</p>

<p>http://bigdata-senior03.chybinmy.com:8088/cluster</p>

<p>四十五、测试YARN HA</p>

<p>5、 运行一个mapreduce job</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/yarn jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.5.0.jar wordcount /wc.input /input
1
6、 在job运行过程中，将Active状态的resourcemanager进程杀掉。</p>

<p>[hadoop@bigdata-senior02 hadoop-2.5.0]$ kill -9 4475
1
7、 观察另外一个resourcemanager是否可以自动接替。</p>

<p>bigdata02的resourcemanage Web客户端已经不能访问，bigdata03的resourcemanage已经自动变为active状态。</p>

<p>8、 观察job是否可以顺利完成。</p>

<p>而mapreduce job 也能顺利完成，没有因为resourcemanager的意外故障而影响运行。</p>

<p>经过以上测试，已经验证YARN HA 已经搭建成功。</p>

<p>第十三步、HDFS Federation 架构部署
四十六、HDFS Federation 的使用原因</p>

<p>1、 单个NameNode节点的局限性</p>

<p>命名空间的限制。</p>

<p>NameNode上存储着整个HDFS上的文件的元数据，NameNode是部署在一台机器上的，因为单个机器硬件的限制，必然会限制NameNode所能管理的文件个数，制约了数据量的增长。</p>

<p>数据隔离问题。</p>

<p>整个HDFS上的文件都由一个NameNode管理，所以一个程序很有可能会影响到整个HDFS上的程序，并且权限控制比较复杂。</p>

<p>性能瓶颈。</p>

<p>单个NameNode时HDFS文件系统的吞吐量受限于单个NameNode的吞吐量。因为NameNode是个JVM进程，JVM进程所占用的内存很大时，性能会下降很多。</p>

<p>2、 HDFS Federation介绍</p>

<p>HDFS Federation是可以在Hadoop集群中设置多个NameNode，不同于HA中多个NameNode是完全一样的，是多个备份，Federation中的多个NameNode是不同的，可以理解为将一个NameNode切分为了多个NameNode，每一个NameNode只负责管理一部分数据。 
HDFS Federation中的多个NameNode共用DataNode。</p>

<p>四十七、HDFS Federation的架构图</p>

<p>enter image description here</p>

<p>四十八、HDFS Federation搭建</p>

<p>1、 服务器角色规划</p>

<p>bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com	bigdata-senior01.chybinmy.com
NameNode1	NameNode2	NameNode3
 	ResourceManage	 
DataNode	DataNode	DataNode
NodeManager	NodeManager	NodeManager
2、 创建HDFS Federation 版本Hadoop程序目录</p>

<p>在bigdata01上创建目录/opt/modules/hadoopfederation /用来存放Hadoop Federation环境。</p>

<p>[hadoop@bigdata-senior01 modules]$ mkdir /opt/modules/hadoopfederation
1
3、 新解压Hadoop 2.5.0</p>

<p>[hadoop@bigdata-senior01 ~]$ tar -zxf /opt/sofeware/hadoop-2.5.0.tar.gz -C /opt/modules/hadoopfederation/
1
4、 配置Hadoop JDK路径</p>

<p>修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件中的JDK路径。</p>

<p>export JAVA_HOME=”/opt/modules/jdk1.7.0_67”</p>

<p>5、 配置hdfs-site.xml</p>

<configuration>
<property>
&lt;!—配置三台NameNode --&gt;
    <name>dfs.nameservices</name>
    <value>ns1,ns2,ns3</value>
  </property>
  <property>
&lt;!—第一台NameNode的机器名和rpc端口，指定了NameNode和DataNode通讯用的端口号 --&gt;
    <name>dfs.namenode.rpc-address.ns1</name>
    <value>bigdata-senior01.chybinmy.com:8020</value>
  </property>
   <property>
&lt;!—第一台NameNode的机器名和rpc端口，备用端口号 --&gt;
    <name>dfs.namenode.serviceerpc-address.ns1</name>
    <value>bigdata-senior01.chybinmy.com:8022</value>
  </property>
  <property>
&lt;!—第一台NameNode的http页面地址和端口号 --&gt;
    <name>dfs.namenode.http-address.ns1</name>
    <value>bigdata-senior01.chybinmy.com:50070</value>
  </property>
<property>
&lt;!—第一台NameNode的https页面地址和端口号 --&gt;
    <name>dfs.namenode.https-address.ns1</name>
    <value>bigdata-senior01.chybinmy.com:50470</value>
  </property>
 
  <property>
    <name>dfs.namenode.rpc-address.ns2</name>
    <value>bigdata-senior02.chybinmy.com:8020</value>
  </property>
   <property>
    <name>dfs.namenode.serviceerpc-address.ns2</name>
    <value>bigdata-senior02.chybinmy.com:8022</value>
  </property>
  <property>
    <name>dfs.namenode.http-address.ns2</name>
    <value>bigdata-senior02.chybinmy.com:50070</value>
  </property>
    <property>
    <name>dfs.namenode.https-address.ns2</name>
    <value>bigdata-senior02.chybinmy.com:50470</value>
  </property>
 
 
  <property>
    <name>dfs.namenode.rpc-address.ns3</name>
    <value>bigdata-senior03.chybinmy.com:8020</value>
  </property>
   <property>
    <name>dfs.namenode.serviceerpc-address.ns3</name>
    <value>bigdata-senior03.chybinmy.com:8022</value>
  </property>
  <property>
    <name>dfs.namenode.http-address.ns3</name>
    <value>bigdata-senior03.chybinmy.com:50070</value>
  </property>
    <property>
    <name>dfs.namenode.https-address.ns3</name>
    <value>bigdata-senior03.chybinmy.com:50470</value>
  </property>
 
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
6、 配置core-site.xml</p>

<configuration>
<property>
    <name>hadoop.tmp.dir</name>
    <value>/opt/modules/hadoopha/hadoop-2.5.0/data/tmp</value>
</property>
</configuration>
<p>1
2
3
4
5
6
hadoop.tmp.dir设置hadoop临时目录地址，默认时，NameNode和DataNode的数据存在这个路径下。</p>

<p>7、 配置slaves文件</p>

<p>bigdata-senior01.chybinmy.com
bigdata-senior02.chybinmy.com
bigdata-senior03.chybinmy.com
1
2
3
8、 配置yarn-site.xml</p>

<configuration>
<property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
 </property>     
 <property>
    <name>yarn.resourcemanager.hostname</name>
    <value>bigdata-senior02.chybinmy.com</value>
 </property>     
 <property>
    <name>yarn.log-aggregation-enable</name>
    <value>true</value>
 </property>     
 <property>
    <name>yarn.log-aggregation.retain-seconds</name>
    <value>106800</value>
 </property>     
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
9、 分发到其他节点</p>

<p>分发之前先将share/doc目录删除，这个目录中是帮助文件，并且很大，可以删除。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/ /opt/modules/hadoopfederation bigdata-senior02.chybinmy.com:/opt/modules
[hadoop@bigdata-senior01 hadoop-2.5.0]$ scp -r /opt/modules/hadoopfederation bigdata-senior03.chybinmy.com:/opt/modules
1
2
10、 格式化NameNode</p>

<p>在第一台上进行NameNode格式化。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs namenode -format -clusterId hadoop-federation-clusterId
1
这里一定要指定一个集群ID，使得多个NameNode的集群ID是一样的，因为这三个NameNode在同一个集群中，这里集群ID为hadoop-federation-clusterId。</p>

<p>在第二台NameNode上。</p>

<p>[hadoop@bigdata-senior02 hadoop-2.5.0]$ bin/hdfs namenode -format -clusterId hadoop-federation-clusterId
1
在第二台NameNode上。</p>

<p>[hadoop@bigdata-senior03 hadoop-2.5.0]$ bin/hdfs namenode -format -clusterId hadoop-federation-clusterId
1
11、 启动NameNode</p>

<p>在第一台、第二台、第三台机器上启动NameNode：</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start namenode
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start namenode
[hadoop@bigdata-senior03 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start namenode
1
2
3
启动后，用jps命令查看是否已经启动成功。</p>

<p>查看HDFS Web页面，此时三个NameNode都是standby状态。</p>

<p>enter image description here</p>

<p>enter image description here</p>

<p>enter image description here</p>

<p>12、 启动DataNode</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start datanode
[hadoop@bigdata-senior02 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start datanode
[hadoop@bigdata-senior03 hadoop-2.5.0]$ sbin/hadoop-daemon.sh start datanode
1
2
3
启动后，用jps命令确认DataNode进程已经启动成功。</p>

<p>四十九、测试HDFS Federation</p>

<p>1、 修改core-site.xml</p>

<p>在bigdata-senior01机器上,修改core-site.xml文件，指定连接的NameNode是第一台NameNode。</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ vim etc/hadoop/core-site.xml</p>

<configuration>
  <property>
     <name>fs.defaultFS</name>
     <value>hdfs://bigdata-senior01.chybinmy.com:8020</value>
  </property>
<property>
    <name>hadoop.tmp.dir</name>
    <value>/opt/modules/hadoopfederation/hadoop-2.5.0/data/tmp</value>
</property>
</configuration>
<p>1
2
3
4
5
6
7
8
9
10
2、 在bigdate-senior01上传一个文件到HDFS</p>

<p>[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -mkdir /tmp
[hadoop@bigdata-senior01 hadoop-2.5.0]$ bin/hdfs dfs -put ~/shuffle_daily.sh /tmp/shuffle_daily.sh
1
2
3、 查看HDFS文件</p>

<p>enter image description here</p>

<p>可以看到，刚才的文件只上传到了bigdate-senior01机器上的NameNode上了，并没有上传到其他的NameNode上去。</p>

<p>这样，在HDFS的客户端，可以指定要上传到哪个NameNode上，从而来达到了划分NameNode的目的。</p>

<p>后记
这篇文章的操作步骤并不是工作中标准的操作流程，如果在成百上千的机器全部这样安装会被累死，希望读者可以通过文章中一步步地安装，从而初步了解到Hadoop的组成部分，协助过程等，这对于Hadoop的深入使用有很大的帮助。</p>

                </div>
                <div class="read-all">
                    <a  href="/2016/03/01/Hadoop1/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/01/05/datamining/">推荐算法--总结</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-01-05
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#数据挖掘" title="Category: 数据挖掘" rel="category">数据挖掘</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#数据挖掘" title="Tag: 数据挖掘" rel="tag">数据挖掘</a>&nbsp;
    
        <a href="/tag/#推荐算法" title="Tag: 推荐算法" rel="tag">推荐算法</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#1推荐算法" id="markdown-toc-1推荐算法">1、推荐算法</a></li>
  <li><a href="#推荐系统的出现" id="markdown-toc-推荐系统的出现">推荐系统的出现</a></li>
  <li><a href="#推荐算法介绍" id="markdown-toc-推荐算法介绍">推荐算法介绍</a></li>
  <li><a href="#2推荐系统与广告投放" id="markdown-toc-2推荐系统与广告投放">2.推荐系统与广告投放</a></li>
</ul>
<h2 id="1推荐算法">1、推荐算法</h2>

<h2 id="推荐系统的出现">推荐系统的出现</h2>

<p>　　随着互联网的发展，人们正处于一个信息爆炸的时代。相比于过去的信息匮乏，面对现阶段海量的信息数据，对信息的筛选和过滤成为了衡量一个系统好坏的重要指标。一个具有良好用户体验的系统，会将海量信息进行筛选、过滤，将用户最关注最感兴趣的信息展现在用户面前。这大大增加了系统工作的效率，也节省了用户筛选信息的时间。</p>

<p>　　搜索引擎的出现在一定程度上解决了信息筛选问题，但还远远不够。搜索引擎需要用户主动提供关键词来对海量信息进行筛选。当用户无法准确描述自己的需求时，搜索引擎的筛选效果将大打折扣，而用户将自己的需求和意图转化成关键词的过程本身就是一个并不轻松的过程。</p>

<p>　　在此背景下，推荐系统出现了，推荐系统的任务就是解决上述的问题，联系用户和信息，一方面帮助用户发现对自己有价值的信息，另一方面让信息能够展现在对他感兴趣的人群中，从而实现信息提供商与用户的双赢。</p>

<p>推荐算法大致可以分为三类：基于内容的推荐算法、协同过滤推荐算法和基于知识的推荐算法。
基于内容的推荐算法，原理是用户喜欢和自己关注过的Item在内容上类似的Item，比如你看了哈利波特I，基于内容的推荐算法发现哈利波特II-VI，与你以前观看的在内容上面（共有很多关键词）有很大关联性，就把后者推荐给你，这种方法可以避免Item的冷启动问题（冷启动：如果一个Item从没有被关注过，其他推荐算法则很少会去推荐，但是基于内容的推荐算法可以分析Item之间的关系，实现推荐），弊端在于推荐的Item可能会重复，典型的就是新闻推荐，如果你看了一则关于MH370的新闻，很可能推荐的新闻和你浏览过的，内容一致；另外一个弊端则是对于一些多媒体的推荐（比如音乐、电影、图片等)由于很难提内容特征，则很难进行推荐，一种解决方式则是人工给这些Item打标签。
协同过滤算法，原理是用户喜欢那些具有相似兴趣的用户喜欢过的商品，比如你的朋友喜欢电影哈利波特I，那么就会推荐给你，这是最简单的基于用户的协同过滤算法（user-based collaboratIve filtering），还有一种是基于Item的协同过滤算法（item-based collaborative filtering），这两种方法都是将用户的所有数据读入到内存中进行运算的，因此成为Memory-based Collaborative Filtering，另一种则是Model-based collaborative filtering，包括Aspect Model，pLSA，LDA，聚类，SVD，Matrix Factorization等，这种方法训练过程比较长，但是训练完成后，推荐过程比较快。
最后一种方法是基于知识的推荐算法，也有人将这种方法归为基于内容的推荐，这种方法比较典型的是构建领域本体，或者是建立一定的规则，进行推荐。
混合推荐算法，则会融合以上方法，以加权或者串联、并联等方式尽心融合。
当然，推荐系统还包括很多方法，其实机器学习或者数据挖掘里面的方法，很多都可以应用在推荐系统中，比如说LR、GBDT、RF（这三种方法在一些电商推荐里面经常用到），社交网络里面的图结构等，都可以说是推荐方法。</p>

<h2 id="推荐算法介绍">推荐算法介绍</h2>

<p>　　1 基于人口统计学的推荐</p>

<p>　　这是最为简单的一种推荐算法，它只是简单的根据系统用户的基本信息发现用户的相关程度，然后将相似用户喜爱的其他物品推荐给当前用户。</p>

<p>　　系统首先会根据用户的属性建模，比如用户的年龄，性别，兴趣等信息。根据这些特征计算用户间的相似度。比如系统通过计算发现用户A和C比较相似。就会把A喜欢的物品推荐给C。</p>

<p>　　优势：</p>

<p>　　a 不需要历史数据，没有冷启动问题</p>

<p>　　b 不依赖于物品的属性，因此其他领域的问题都可无缝接入。</p>

<p>　　不足：</p>

<p>　　算法比较粗糙，效果很难令人满意，只适合简单的推荐</p>

<p>　　2 基于内容的推荐</p>

<p>　　与上面的方法相类似，只不过这次的中心转到了物品本身。使用物品本身的相似度而不是用户的相似度。</p>

<p>　　系统首先对物品（图中举电影的例子）的属性进行建模，图中用类型作为属性。在实际应用中，只根据类型显然过于粗糙，还需要考虑演员，导演等更多信息。通过相似度计算，发现电影A和C相似度较高，因为他们都属于爱情类。系统还会发现用户A喜欢电影A，由此得出结论，用户A很可能对电影C也感兴趣。于是将电影C推荐给A。</p>

<p>　　优势：</p>

<p>　　对用户兴趣可以很好的建模，并通过对物品属性维度的增加，获得更好的推荐精度</p>

<p>　　不足：</p>

<p>　　a 物品的属性有限，很难有效的得到更多数据</p>

<p>　　b 物品相似度的衡量标准只考虑到了物品本身，有一定的片面性</p>

<p>　　c 需要用户的物品的历史数据，有冷启动的问题</p>

<p> 
　　3 协同过滤</p>

<p>　　协同过滤是推荐算法中最经典最常用的，具体的思路我已经在之前的一篇文章中提到过，大家可以去看一下。</p>

<p>　　这里只想介绍一下协同过滤中的方法和刚才提到方法的区别。</p>

<p>　　大家都知道协同过滤分为基于用户的协同过滤和基于物品的协同过滤。那么他们和基于人口学统计的推荐和基于内容的推荐有什么区别和联系呢？下面简单介绍一下。</p>

<p>　　基于用户的协同过滤——基于人口统计学的推荐</p>

<p>　　基于用户的协同过滤推荐机制和基于人口统计学的推荐机制都是计算用户的相似度，并基于“邻居”用户群计算推荐，但它们所不同的是如何计算用户的相似度，基 于人口统计学的机制只考虑用户本身的特征，而基于用户的协同过滤机制可是在用户的历史偏好的数据上计算用户的相似度，它的基本假设是，喜欢类似物品的用户 可能有相同或者相似的口味和偏好。</p>

<p>　　基于物品的协同过滤——基于内容的推荐</p>

<p>　　基于项目的协同过滤推荐和基于内容的推荐其实都是基于物品相似度预测推荐，只是相似度计算的方法不一样，前者是从用户历史的偏好推断，而后者是基于物品本身的属性特征信息。</p>

<p>　　协同过滤的优势：</p>

<p>　　a 它不需要对物品或者用户进行严格的建模，而且不要求物品的描述是机器可理解的，所以这种方法也是领域无关的。</p>

<p>　　b 这种方法计算出来的推荐是开放的，可以共用他人的经验，很好的支持用户发现潜在的兴趣偏好</p>

<p>　　不足：</p>

<p>　　a 方法的核心是基于历史数据，所以对新物品和新用户都有“冷启动”的问题。</p>

<p>　　b 推荐的效果依赖于用户历史偏好数据的多少和准确性。</p>

<p>　　c 在大部分的实现中，用户历史偏好是用稀疏矩阵进行存储的，而稀疏矩阵上的计算有些明显的问题，包括可能少部分人的错误偏好会对推荐的准确度有很大的影响等等。</p>

<p>　　d 对于一些特殊品味的用户不能给予很好的推荐。</p>

<p>　　e 由于以历史数据为基础，抓取和建模用户的偏好后，很难修改或者根据用户的使用演变，从而导致这个方法不够灵活。</p>

<p>      4 基于关联规则的推荐</p>

<p>基于关联规则的推荐更常见于电子商务系统中，并且也被证明行之有效。其实际的意义为购买了一些物品的用户更倾向于购买另一些物品。基于关联规则的推荐系统的首要目标是挖掘出关联规则，也就是那些同时被很多用户购买的物品集合，这些集合内的物品可以相互进行推荐。目前关联规则挖掘算法主要从Apriori和FP-Growth两个算法发展演变而来。</p>

<p>基于关联规则的推荐系统一般转化率较高，因为当用户已经购买了频繁集合中的若干项目后，购买该频繁集合中其他项目的可能性更高。该机制的缺点在于：</p>

<p>l计算量较大，但是可以离线计算，因此影响不大。</p>

<p>l由于采用用户数据，不可避免的存在冷启动和稀疏性问题。</p>

<p>l存在热门项目容易被过度推荐的问题。</p>

<p>　　5 混合推荐算法</p>

<p>　　以上介绍的方法是推荐领域最常见的几种方法。但是可以看出，每个方法都不是完美的。因此实际应用中，向Amazon这样的系统都是混合使用各种推荐算法，各取所长。因此我们在使用时，也可以多考虑一下什么情况下更适合使用哪种算法，来提高我们系统的效率。</p>

<p>推荐系统的发展方向</p>

<p>　　1 需要考虑在保证推荐准确性的同时增加推荐的多样性，使特殊喜好的用户得到推荐</p>

<p>　　2 需要考虑用户对系统的实时反馈，更好的利用反馈数据强化推荐算法</p>

<p>　　3 考虑时间，空间，任务等因素，来更好的完成推荐</p>

<h2 id="2推荐系统与广告投放">2.推荐系统与广告投放</h2>


                </div>
                <div class="read-all">
                    <a  href="/2016/01/05/datamining/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2016/01/05/datamining/">数据挖掘、机器学习、深度学习、推荐算法的联系与差别总结</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2016-01-05
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#数据挖掘" title="Category: 数据挖掘" rel="category">数据挖掘</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#数据挖掘" title="Tag: 数据挖掘" rel="tag">数据挖掘</a>&nbsp;
    
        <a href="/tag/#机器学习" title="Tag: 机器学习" rel="tag">机器学习</a>&nbsp;
    
        <a href="/tag/#深度学习" title="Tag: 深度学习" rel="tag">深度学习</a>&nbsp;
    
        <a href="/tag/#推荐算法" title="Tag: 推荐算法" rel="tag">推荐算法</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <p>网上搜索了一堆，最后对这几个概念的联系与差别总结如下：</p>

<p>1.数据挖掘：data mining，是一个很宽泛的概念。字面的意思是从成吨的数据里面挖掘有用的信息。这个工作BI（商业智能）可以做，数据分析可以做，甚至市场运营也可以做。利用Excel分析数据，发现了一些有用的信息，然后通过这些信息指导你的Business的过程也是数据挖掘的过程。</p>

<p>2.机器学习：machine learning，是计算机科学和统计学的交叉学科，基本目标是学习一个x-&gt;y的函数（映射），来做分类或者回归的工作。之所以经常和数据挖掘合在一起讲是因为现在好多数据挖掘的工作是通过机器学习提供的算法工具实现的，例如广告的ctr预估，PB级别的点击日志在通过典型的机器学习流程可以得到一个预估模型，从而提高互联网广告的点击率和回报率；个性化推荐，还是通过机器学习的一些算法分析平台上的各种购买，浏览和收藏日志，得到一个推荐模型，来预测你喜欢的商品。</p>

<p>3.深度学习：deep learning，机器学习里面现在比较火的一个topic（大坑），本身是神经网络算法的衍生，在图像，语音等富媒体的分类和识别上取得了非常好的效果，所以各大研究机构和公司都投入了大量的人力做相关的研究和开发。</p>

<p>总结下，数据挖掘是个很宽泛的概念，数据挖掘常用方法大多来自于机器学习这门学科，深度学习是机器学习一类比较火的算法，本质上还是原来的神经网络。</p>

<p>4.推荐算法：机器学习是方法，人工智能/数据挖掘是应用，可以使用机器学习，也可以使用别的方法。数据挖掘有很多应用场景，推荐系统是其中一个业务目的明确的, 有一定历史的，成体系的，已经形成较为完善的经验积累的应用场景。数据挖掘中还有很多应用场景有待开发，连是否能挖出有价值的模式都不知道。像推荐系统，计算机视觉，nlp这些价值已知的场景，明显是要幸运一些。写书的当然什么都要写写啦，难道机器学习里有的东西，推荐系统的书就不能写了？再说这些书侧重点不同，推荐系统里讲的机器学习算法更贴近推荐业务，侧重于算法应用，应用效果，对具体业务指标的影响，给整个系统带来的局限或提升等等。肯定不会像统计学习基础那样给你讲一堆推倒过程，讲统计特性，更不会像统计学习理论那样再给你来几下证明。这些书都有说机器学习，但是角度不同。如果讲机器学习算法的书和讲推荐系统的书在讲机器学习算法时基本差不多，那么那本讲机器学习的书也基本可以扔掉了。</p>


                </div>
                <div class="read-all">
                    <a  href="/2016/01/05/datamining/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <a href="/index.html" class="previous"><i class="fa fa-angle-double-left"></i></a>
            <a href="/page9" class="previous"><i class="fa fa-angle-left"></i></a>
          
          <span class="page_number ">10/10</span>
          
            <span class="next disable"><i class="fa fa-angle-right"></i></span>
            <span class="next disable"><i class="fa fa-angle-double-right"></i></span>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    最近文章
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2019/01/25/test/">Hello World!</a></li>
                    
                        <li><a href="/2019/01/19/dl/">深度学习与语音识别—常用声学模型简介</a></li>
                    
                        <li><a href="/2019/01/16/datamining/">Kmeans文本聚类实施过程</a></li>
                    
                        <li><a href="/2018/11/23/datamining/">文本数据挖掘-----词向量</a></li>
                    
                        <li><a href="/2018/10/28/datamining/">TF-IDF提取文章关键词算法</a></li>
                    
                        <li><a href="/2018/10/12/datamining/">基于用户的协同过滤推荐算法java实现（UserCF）</a></li>
                    
                        <li><a href="/2018/10/05/datamining/">Louvain 社团发现算法学习</a></li>
                    
                        <li><a href="/2018/09/26/datamining/">使用python提取文章关键词</a></li>
                    
                        <li><a href="/2018/07/11/datamining/">基于内容的推荐 java实现</a></li>
                    
                        <li><a href="/2018/07/11/datamining/">机器学习算法——PCA算法介绍以及Java实现</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    目录
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#数据挖掘" class="categories-list-item" cate="数据挖掘">
                            <span class="name">
                                数据挖掘
                            </span>
                            <span class="badge">10</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#大数据技术" class="categories-list-item" cate="大数据技术">
                            <span class="name">
                                大数据技术
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#GitHub" class="categories-list-item" cate="GitHub">
                            <span class="name">
                                GitHub
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#JavaScript" class="categories-list-item" cate="JavaScript">
                            <span class="name">
                                JavaScript
                            </span>
                            <span class="badge">7</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Python" class="categories-list-item" cate="Python">
                            <span class="name">
                                Python
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Java" class="categories-list-item" cate="Java">
                            <span class="name">
                                Java
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#开发工具" class="categories-list-item" cate="开发工具">
                            <span class="name">
                                开发工具
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#算法和数据结构" class="categories-list-item" cate="算法和数据结构">
                            <span class="name">
                                算法和数据结构
                            </span>
                            <span class="badge">6</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#jekyll" class="categories-list-item" cate="jekyll">
                            <span class="name">
                                jekyll
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#机器学习" class="categories-list-item" cate="机器学习">
                            <span class="name">
                                机器学习
                            </span>
                            <span class="badge">7</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#R" class="categories-list-item" cate="R">
                            <span class="name">
                                R
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Python网络爬虫" class="categories-list-item" cate="Python网络爬虫">
                            <span class="name">
                                Python网络爬虫
                            </span>
                            <span class="badge">6</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#深度学习" class="categories-list-item" cate="深度学习">
                            <span class="name">
                                深度学习
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#数据分析" class="categories-list-item" cate="数据分析">
                            <span class="name">
                                数据分析
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    标签
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                      
                      
                      
                      
                      
                      <a href="/tag/#数据挖掘" style="font-size: 18pt; color: #000;">数据挖掘</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#机器学习" style="font-size: 15.5pt; color: #333;">机器学习</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#深度学习" style="font-size: 11pt; color: #777;">深度学习</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#推荐算法" style="font-size: 12.5pt; color: #555;">推荐算法</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Hadoop" style="font-size: 9pt; color: #999;">Hadoop</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#大数据技术" style="font-size: 10pt; color: #888;">大数据技术</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#GitHub" style="font-size: 10pt; color: #888;">GitHub</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#同步" style="font-size: 9pt; color: #999;">同步</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#fork" style="font-size: 9pt; color: #999;">fork</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#JavaScript" style="font-size: 12.5pt; color: #555;">JavaScript</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#python" style="font-size: 14.5pt; color: #444;">python</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Git" style="font-size: 9pt; color: #999;">Git</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#算法" style="font-size: 9pt; color: #999;">算法</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Java" style="font-size: 17pt; color: #111;">Java</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Myeclipse" style="font-size: 9pt; color: #999;">Myeclipse</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#软件开发工具" style="font-size: 9pt; color: #999;">软件开发工具</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#数据结构" style="font-size: 13.5pt; color: #444;">数据结构</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#剑指offer" style="font-size: 13.5pt; color: #444;">剑指offer</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#面试" style="font-size: 13.5pt; color: #444;">面试</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#jekyll" style="font-size: 11pt; color: #777;">jekyll</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#RubyGems" style="font-size: 9pt; color: #999;">RubyGems</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#markdown" style="font-size: 9pt; color: #999;">markdown</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#开发工具" style="font-size: 9pt; color: #999;">开发工具</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Sublime" style="font-size: 9pt; color: #999;">Sublime</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#R" style="font-size: 9pt; color: #999;">R</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#正则" style="font-size: 9pt; color: #999;">正则</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Regular" style="font-size: 9pt; color: #999;">Regular</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Python" style="font-size: 13.5pt; color: #444;">Python</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#网络爬虫" style="font-size: 13.5pt; color: #444;">网络爬虫</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#文本挖掘" style="font-size: 11.5pt; color: #666;">文本挖掘</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#中文分词" style="font-size: 11pt; color: #777;">中文分词</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#数据分析" style="font-size: 10pt; color: #888;">数据分析</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#可视化" style="font-size: 9pt; color: #999;">可视化</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Hive" style="font-size: 9pt; color: #999;">Hive</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#特征选择" style="font-size: 10pt; color: #888;">特征选择</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#DNN" style="font-size: 9pt; color: #999;">DNN</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#情感分析" style="font-size: 9pt; color: #999;">情感分析</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#神经网络" style="font-size: 10pt; color: #888;">神经网络</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#数据仓库" style="font-size: 9pt; color: #999;">数据仓库</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#ETL" style="font-size: 9pt; color: #999;">ETL</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#java" style="font-size: 11pt; color: #777;">java</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#PCA" style="font-size: 9pt; color: #999;">PCA</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#kmeans" style="font-size: 9pt; color: #999;">kmeans</a>
                    
                </div>
            </div>

            <!-- <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul  class="content-ul">

                </ul>
            </div> -->
        </div>
    </div>
</div>
<!-- <script src="/js/scroll.min.js " charset="utf-8"></script> -->
<!-- <script src="/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             好好学习，天天向上！ 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/wysheng" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:wyshengcn@163.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
